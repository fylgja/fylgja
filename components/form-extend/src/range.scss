/**
 * Fylgja (https://fylgja.dev)
 * Licensed under MIT Open Source
 */

$track-size: 1ex !default;
$track-color: color-mix(in srgb, currentcolor 24%, canvas) !default;
$track-radius: 0.3rem !default;

@mixin thumb {
	appearance: none;
	block-size: var(--thumb-size-y);
	inline-size: var(--thumb-size-x);
	box-shadow: var(--thumb-shadow);
	border-radius: var(--thumb-radius);
	border: solid var(--thumb-stroke);
	border-width: var(--thumb-stroke-size);
	background-color: var(--thumb-color);
	cursor: grab;

	&:active {
		cursor: grabbing;
	}
}

:where(input[type="range"]) {
	--range-value: 0;

	--track-size: #{$track-size};
	--track-fill: var(--form-active-color, currentcolor);
	--track-color: #{$track-color};
	--track-radius: #{$track-radius};
	--track-dir: to right;

	--thumb-radius: 1em;
	--thumb-stroke: var(--root-bg);
	--thumb-stroke-size: 0.5ex;
	--thumb-size-y: 2em;
	--thumb-size-x: 2em;
	--thumb-color: var(--form-active-color, currentcolor);

	display: block;
	appearance: none;
	min-block-size: var(--thumb-size-y);
	inline-size: min(100%, 30ex);
	margin: 0;
	background: none;

	&:dir(rtl) {
		--track-dir: to left;
	}

	&::-webkit-slider-runnable-track {
		--_val: calc(var(--range-value) * 100% / 100);
		block-size: var(--track-size);
		border-radius: var(--track-radius);
		background: var(--track-color)
			linear-gradient(
				var(--track-dir),
				var(--track-fill) var(--_val),
				var(--track-color) var(--_val)
			);
	}

	&::-moz-range-track {
		block-size: var(--track-size);
		border-radius: var(--track-radius);
		background: var(--track-color);
	}

	&::-webkit-slider-thumb {
		@include thumb;
		margin-block-start: var(
			--thumb-offset,
			calc(0.5 * (var(--track-size) - var(--thumb-size-y)))
		);
	}

	&::-moz-range-thumb {
		@include thumb;
		box-sizing: border-box;
	}
}
